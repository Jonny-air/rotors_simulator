<?xml version="1.0"?>

<robot xmlns:xacro="http://ros.org/wiki/xacro">

<!-- Macro to add a hook for payload grasping-->
<xacro:macro name="payload_hook_simple" params="namespace">

  <xacro:include filename="$(find rotors_description)/urdf/inertias.xacro" />
  <link name="${namespace}/payload_hook">
    <inertial>
      <origin xyz="-0.7 0 -0.170" rpy="0 0 0" />
      <mass value="0.1" />
      <xacro:tube_inertia_x r1="0.008" r2="0.01" h="0.5" mass="0.1"/>
    </inertial>
    <visual>
       <origin xyz="-0.022 0 -0.163" rpy="0 0 0" />
       <geometry>
           <mesh filename="package://rotors_description/meshes/payloads/hook_main.stl" scale="1 1 1" />
       </geometry>
    </visual>
  </link>
  <gazebo reference="${namespace}/payload_hook">
    <material>Gazebo/Grey</material>
  </gazebo>
  <joint name="${namespace}/hook_ext" type="fixed">
     <parent link="${namespace}/payload_hook" />
     <child link="${namespace}/payload_hook_ext" />
  </joint>
  <link name="${namespace}/payload_hook_ext">
     <inertial>
        <mass value="0.001" />
        <xacro:box_inertia x="0.001" y="0.001" z="0.001" mass="0.001" />
     </inertial>
     <visual>
       <origin xyz="-0.022 0 -0.163" rpy="0 0 0" />
        <geometry>
           <mesh filename="package://rotors_description/meshes/payloads/hook_tail.stl" scale="1 1 1" />
        </geometry>
     </visual>
  </link>
  <gazebo reference="${namespace}/payload_hook_ext">
    <material>Gazebo/Grey</material>
  </gazebo>

  <joint name="${namespace}/pyld_hk_joint" type="continuous">
    <origin xyz="0.022 0 -0.05" rpy="0 0 0" />
    <axis xyz="0 1 0" />
    <dynamics damping="0.1"/>
    <parent link="${namespace}/base_link" />
    <child link="${namespace}/payload_hook" />
  </joint>

  <gazebo>
     <plugin filename="librotors_gazebo_aerodynamics_plugin.so" name="aerodynamics_plugin">
        <robotNamespace>${namespace}</robotNamespace>
        <linkName>${namespace}/payload_hook</linkName>
        <aeroForcesVis>aero_force_vis_hook_elev</aeroForcesVis>
        <airfoil>
           <segment name="HS_HK">
              <forward>0.866 0 -0.5</forward>
              <upward>0.5 0 0.866</upward>
              <cp>-1.3 0 0</cp>
              <seg_area>0.045</seg_area>
              <seg_chord>0.12</seg_chord>
              <aeroParamsYAML>${yaml_path}/techpod_TJ_tail_h.yaml</aeroParamsYAML>
              <wind name="wind">
                <topic>wind_base_link</topic>
              </wind>
           </segment>
        </airfoil>
     </plugin>
  </gazebo>
</xacro:macro>

</robot>
